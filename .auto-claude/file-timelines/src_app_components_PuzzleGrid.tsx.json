{
  "file_path": "src/app/components/PuzzleGrid.tsx",
  "main_branch_history": [],
  "task_views": {
    "004-add-cross-stage-confidence-warnings-to-ui": {
      "task_id": "004-add-cross-stage-confidence-warnings-to-ui",
      "branch_point": {
        "commit_hash": "faf3f69f9b2794c6a85ffd2581461d3d68bdf8ef",
        "content": "",
        "timestamp": "2025-12-22T03:09:58.791154"
      },
      "worktree_state": {
        "content": "import React, { useMemo, useState } from 'react';\nimport { Text, View, PanResponder, GestureResponderEvent, PanResponderGestureState } from 'react-native';\nimport Svg, { Rect, G, Text as SvgText, Line } from 'react-native-svg';\nimport { PuzzleSpec, SolutionGrid } from '../../model/types';\n\ninterface Props {\n  puzzle: PuzzleSpec;\n  solution?: SolutionGrid;\n}\n\nconst regionPalette = ['#2a2f4f', '#4a60c4', '#519872', '#b48b7d', '#c44569', '#f2c14e', '#2c699a'];\n\nconst cellSize = 48;\n\nexport default function PuzzleGrid({ puzzle, solution }: Props) {\n  const [scale, setScale] = useState(1);\n  const [offset, setOffset] = useState({ x: 0, y: 0 });\n\n  const panResponder = useMemo(\n    () =>\n      PanResponder.create({\n        onMoveShouldSetPanResponder: () => true,\n        onPanResponderMove: (_: GestureResponderEvent, gesture: PanResponderGestureState) => {\n          setOffset({ x: gesture.dx, y: gesture.dy });\n        },\n        onPanResponderRelease: (_evt, gesture) => {\n          setOffset((prev) => ({ x: prev.x + gesture.dx, y: prev.y + gesture.dy }));\n        },\n        onPanResponderTerminationRequest: () => true,\n        onPanResponderGrant: () => {},\n        onPanResponderEnd: () => {},\n      }),\n    [],\n  );\n\n  const width = puzzle.cols * cellSize * scale;\n  const height = puzzle.rows * cellSize * scale;\n\n  return (\n    <View {...panResponder.panHandlers}>\n      <Svg width={width} height={height}>\n        <G transform={`translate(${offset.x},${offset.y}) scale(${scale})`}>\n          {puzzle.regions.map((row, r) =>\n            row.map((region, c) => {\n              const color = regionPalette[region % regionPalette.length];\n              return (\n                <Rect\n                  key={`${r}-${c}`}\n                  x={c * cellSize}\n                  y={r * cellSize}\n                  width={cellSize}\n                  height={cellSize}\n                  fill={color}\n                  stroke=\"#111\"\n                  strokeWidth={1}\n                  opacity={0.8}\n                />\n              );\n            }),\n          )}\n          {solution &&\n            solution.gridPips.map((row, r) =>\n              row.map((pip, c) => (\n                <SvgText key={`pip-${r}-${c}`} x={c * cellSize + cellSize / 2} y={r * cellSize + cellSize / 1.6} fill=\"#fff\" fontSize={18} textAnchor=\"middle\">\n                  {pip}\n                </SvgText>\n              )),\n            )}\n          {solution &&\n            solution.dominoes.map((domino) => {\n              const [[r1, c1], [r2, c2]] = domino.cells;\n              return (\n                <Line\n                  key={domino.id}\n                  x1={c1 * cellSize + cellSize / 2}\n                  y1={r1 * cellSize + cellSize / 2}\n                  x2={c2 * cellSize + cellSize / 2}\n                  y2={r2 * cellSize + cellSize / 2}\n                  stroke=\"#f2c14e\"\n                  strokeWidth={4}\n                />\n              );\n            })}\n        </G>\n      </Svg>\n      <View style={{ flexDirection: 'row', justifyContent: 'space-between', paddingHorizontal: 12, marginTop: 6 }}>\n        <Text style={{ color: '#9aa5ce' }}>Pinch via OS zoom; drag to pan.</Text>\n        <Text style={{ color: '#9aa5ce' }}>Scale: {scale.toFixed(1)}</Text>\n      </View>\n    </View>\n  );\n}\n",
        "last_modified": "2025-12-22T03:10:02.198521"
      },
      "task_intent": {
        "title": "004-add-cross-stage-confidence-warnings-to-ui",
        "description": "Display the confidence hints generated by generateConfidenceHints() in the mobile app's extraction results screen. The backend already computes these hints but the UI only shows the overall confidence percentage.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2025-12-22T03:09:59.305854",
  "last_updated": "2025-12-22T03:09:59.406996"
}