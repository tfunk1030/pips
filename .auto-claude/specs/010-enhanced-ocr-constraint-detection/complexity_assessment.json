{
  "complexity": "standard",
  "workflow_type": "feature",
  "confidence": 0.85,
  "reasoning": "OCR enhancement requires preprocessing research and affects 4-6 files across 1-2 services. Pytesseract and OpenCV already exist in the codebase, but optimal preprocessing techniques need research. No external integrations or infrastructure changes required.",

  "analysis": {
    "scope": {
      "estimated_files": 5,
      "estimated_services": 2,
      "is_cross_cutting": false,
      "notes": "Primary work in pips-agent OCR logic. May touch cv-service preprocessing endpoint. Estimated files: OCR module, preprocessing utils, configuration, tests."
    },
    "integrations": {
      "external_services": [],
      "new_dependencies": [],
      "research_needed": true,
      "notes": "No new external services. Pytesseract and OpenCV already in use. Research needed for optimal preprocessing techniques (adaptive thresholding, noise reduction, contrast enhancement, deskewing)."
    },
    "infrastructure": {
      "docker_changes": false,
      "database_changes": false,
      "config_changes": true,
      "notes": "May add .env variables for OCR configuration (confidence thresholds, preprocessing flags, debug modes). No Docker or database changes."
    },
    "knowledge": {
      "patterns_exist": true,
      "research_required": true,
      "unfamiliar_tech": [],
      "notes": "Pytesseract and OpenCV patterns exist in codebase. Research required for OCR preprocessing best practices: image normalization, noise reduction, text enhancement techniques. All technologies are familiar."
    },
    "risk": {
      "level": "medium",
      "concerns": [
        "Regression risk - don't break existing OCR functionality",
        "Performance impact - preprocessing pipeline may slow down OCR",
        "Accuracy validation - need test dataset to validate 90% target",
        "Edge cases - mobile screenshots vary widely in quality",
        "Parameter tuning - preprocessing thresholds need optimization"
      ],
      "notes": "Medium risk due to user-facing accuracy requirements and performance considerations. Mitigation: comprehensive testing with diverse image samples, A/B comparison with current implementation."
    }
  },

  "recommended_phases": [
    "discovery",
    "requirements",
    "research",
    "context",
    "spec_writing",
    "planning",
    "validation"
  ],

  "flags": {
    "needs_research": true,
    "needs_self_critique": false,
    "needs_infrastructure_setup": false
  },

  "validation_recommendations": {
    "risk_level": "medium",
    "skip_validation": false,
    "minimal_mode": false,
    "test_types_required": ["unit", "integration"],
    "security_scan_required": false,
    "staging_deployment_required": false,
    "reasoning": "OCR accuracy is critical to user experience. Requires unit tests for preprocessing functions and integration tests for end-to-end constraint detection. No security concerns (image processing only), no deployment complexity."
  },

  "created_at": "2025-12-22T10:30:00Z"
}
