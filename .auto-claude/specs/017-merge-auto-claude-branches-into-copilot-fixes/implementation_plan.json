{
  "feature": "Merge All Auto-Claude Branches into Copilot-Fixes",
  "workflow_type": "feature",
  "workflow_rationale": "This is a feature workflow because it implements a specific git branch consolidation process that requires careful sequential execution, verification at each step, and potential conflict resolution. While it doesn't modify application code, it implements a new branch management procedure.",

  "phases": [
    {
      "id": "phase-1-preparation",
      "name": "Preparation & Validation",
      "type": "setup",
      "description": "Validate git state, create backup, and prepare for merge operations",
      "depends_on": [],
      "parallel_safe": false,
      "subtasks": [
        {
          "id": "subtask-1-1",
          "description": "Validate repository state and create pre-merge backup",
          "service": "repository",
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "command",
            "command": "git tag -l 'pre-merge-backup'",
            "expected": "pre-merge-backup"
          },
          "status": "pending",
          "notes": "Creates backup tag and validates that we're not in detached HEAD state"
        },
        {
          "id": "subtask-1-2",
          "description": "Handle uncommitted changes on copilot-fixes branch",
          "service": "repository",
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "command",
            "command": "git status --porcelain",
            "expected": ""
          },
          "status": "pending",
          "notes": "Commit or stash existing changes on copilot-fixes before starting merges"
        },
        {
          "id": "subtask-1-3",
          "description": "Identify and count all auto-claude branches to merge",
          "service": "repository",
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "command",
            "command": "git branch --list 'auto-claude*' | wc -l",
            "expected": "17"
          },
          "status": "pending",
          "notes": "Validates we have the expected 17 auto-claude branches"
        }
      ]
    },
    {
      "id": "phase-2-commit-changes",
      "name": "Commit Uncommitted Changes",
      "type": "implementation",
      "description": "Process each auto-claude branch and commit any uncommitted changes",
      "depends_on": ["phase-1-preparation"],
      "parallel_safe": false,
      "subtasks": [
        {
          "id": "subtask-2-1",
          "description": "Process branches 001-005: commit uncommitted changes",
          "service": "repository",
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "manual",
            "instructions": "Verify git status on each branch shows 'nothing to commit, working tree clean'"
          },
          "status": "pending",
          "notes": "Checkout each branch, check git status, commit changes if needed with message 'chore: commit changes before merge into copilot-fixes'"
        },
        {
          "id": "subtask-2-2",
          "description": "Process branches 006-010: commit uncommitted changes",
          "service": "repository",
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "manual",
            "instructions": "Verify git status on each branch shows 'nothing to commit, working tree clean'"
          },
          "status": "pending",
          "notes": "Checkout each branch, check git status, commit changes if needed"
        },
        {
          "id": "subtask-2-3",
          "description": "Process branches 011-017: commit uncommitted changes",
          "service": "repository",
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "manual",
            "instructions": "Verify git status on each branch shows 'nothing to commit, working tree clean'"
          },
          "status": "pending",
          "notes": "Checkout each branch, check git status, commit changes if needed"
        }
      ]
    },
    {
      "id": "phase-3-merge-branches",
      "name": "Merge Branches into Copilot-Fixes",
      "type": "implementation",
      "description": "Sequentially merge all auto-claude branches into copilot-fixes with no-ff flag",
      "depends_on": ["phase-2-commit-changes"],
      "parallel_safe": false,
      "subtasks": [
        {
          "id": "subtask-3-1",
          "description": "Merge branches 001-005 into copilot-fixes",
          "service": "repository",
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "command",
            "command": "git log copilot-fixes --oneline --grep='merge:' | grep -E 'auto-claude/00[1-5]' | wc -l",
            "expected": "5"
          },
          "status": "pending",
          "notes": "Use 'git merge <branch> --no-ff -m \"merge: <branch> into copilot-fixes\"'. If conflicts occur, STOP and document."
        },
        {
          "id": "subtask-3-2",
          "description": "Merge branches 006-010 into copilot-fixes",
          "service": "repository",
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "command",
            "command": "git log copilot-fixes --oneline --grep='merge:' | grep -E 'auto-claude/0(0[6-9]|10)' | wc -l",
            "expected": "5"
          },
          "status": "pending",
          "notes": "Continue sequential merging. Verify clean working directory after each merge."
        },
        {
          "id": "subtask-3-3",
          "description": "Merge branches 011-017 into copilot-fixes",
          "service": "repository",
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "command",
            "command": "git log copilot-fixes --oneline --grep='merge:' | grep -E 'auto-claude/01[1-7]' | wc -l",
            "expected": "7"
          },
          "status": "pending",
          "notes": "Final batch of merges. Total merged branches should be 17."
        }
      ]
    },
    {
      "id": "phase-4-verification",
      "name": "Verification & Documentation",
      "type": "integration",
      "description": "Verify all merges completed successfully and document the operation",
      "depends_on": ["phase-3-merge-branches"],
      "parallel_safe": false,
      "subtasks": [
        {
          "id": "subtask-4-1",
          "description": "Verify all 17 branches are merged into copilot-fixes",
          "service": "repository",
          "all_services": false,
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "command",
            "command": "git branch --merged copilot-fixes | grep 'auto-claude' | wc -l",
            "expected": "17"
          },
          "status": "pending",
          "notes": "All auto-claude branches should appear in merged list"
        },
        {
          "id": "subtask-4-2",
          "description": "Verify repository integrity and no merge artifacts",
          "service": "repository",
          "all_services": false,
          "files_to_modify": [],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "e2e",
            "steps": [
              "Run 'git fsck --full' to verify repository integrity",
              "Search for merge conflict markers: git grep -n '<<<<<<< HEAD' (should find nothing)",
              "Verify clean working directory: git status",
              "Check merge history visualization: git log --graph --oneline --all -30"
            ]
          },
          "status": "pending",
          "notes": "Final integrity checks to ensure clean merge state"
        },
        {
          "id": "subtask-4-3",
          "description": "Document merge operation in build-progress.txt",
          "service": "repository",
          "all_services": false,
          "files_to_modify": ["build-progress.txt"],
          "files_to_create": [],
          "patterns_from": [],
          "verification": {
            "type": "manual",
            "instructions": "Verify build-progress.txt contains summary of all merged branches with counts and any conflicts encountered"
          },
          "status": "pending",
          "notes": "Update build-progress.txt with final merge summary and verification results"
        }
      ]
    }
  ],

  "summary": {
    "total_phases": 4,
    "total_subtasks": 10,
    "services_involved": ["repository"],
    "parallelism": {
      "max_parallel_phases": 1,
      "parallel_groups": [],
      "recommended_workers": 1,
      "speedup_estimate": "Sequential processing required - no parallelization possible",
      "reasoning": "Git merge operations must be sequential to maintain clean state and handle potential conflicts. Each merge depends on the previous merge completing successfully."
    },
    "startup_command": "source auto-claude/.venv/bin/activate && python auto-claude/run.py --spec 017 --parallel 1"
  },

  "verification_strategy": {
    "risk_level": "low",
    "skip_validation": false,
    "test_creation_phase": "none",
    "test_types_required": [],
    "security_scanning_required": false,
    "staging_deployment_required": false,
    "acceptance_criteria": [
      "All 17 auto-claude branches successfully merged into copilot-fixes",
      "No merge conflicts remain unresolved",
      "Working directory is clean (git status shows no uncommitted changes)",
      "No merge artifact markers (<<<<<<, =======, >>>>>>>) in codebase",
      "Git repository integrity verified (git fsck passes)",
      "All branches appear in 'git branch --merged copilot-fixes'",
      "Merge history is preserved and visible in git log",
      "Pre-merge backup tag exists for rollback capability",
      "Build-progress.txt documents the operation",
      "All service directories remain intact"
    ],
    "verification_steps": [
      {
        "name": "Merged Branch Count",
        "command": "git branch --merged copilot-fixes | grep 'auto-claude' | wc -l",
        "expected_outcome": "17 branches merged",
        "type": "command",
        "required": true,
        "blocking": true
      },
      {
        "name": "Clean Working Directory",
        "command": "git status --porcelain",
        "expected_outcome": "Empty output (clean state)",
        "type": "command",
        "required": true,
        "blocking": true
      },
      {
        "name": "No Merge Conflicts",
        "command": "git grep -n '<<<<<<< HEAD'",
        "expected_outcome": "No matches found",
        "type": "command",
        "required": true,
        "blocking": true
      },
      {
        "name": "Repository Integrity",
        "command": "git fsck --full",
        "expected_outcome": "No errors reported",
        "type": "command",
        "required": true,
        "blocking": true
      },
      {
        "name": "Merge Commits Present",
        "command": "git log copilot-fixes --oneline --grep='merge:' | wc -l",
        "expected_outcome": "At least 17 merge commits",
        "type": "command",
        "required": true,
        "blocking": true
      },
      {
        "name": "Backup Tag Exists",
        "command": "git tag -l 'pre-merge-backup'",
        "expected_outcome": "Tag exists",
        "type": "command",
        "required": true,
        "blocking": false
      }
    ],
    "reasoning": "Low risk git operations require verification that all merges completed successfully without data loss or corruption. No functional code testing needed since this is pure branch management."
  },

  "qa_acceptance": {
    "unit_tests": {
      "required": false,
      "commands": [],
      "minimum_coverage": null
    },
    "integration_tests": {
      "required": false,
      "commands": [],
      "services_to_test": []
    },
    "e2e_tests": {
      "required": false,
      "commands": [],
      "flows": []
    },
    "browser_verification": {
      "required": false,
      "pages": []
    },
    "database_verification": {
      "required": false,
      "checks": []
    },
    "git_state_verification": {
      "required": true,
      "checks": [
        "All auto-claude branches merged",
        "Clean working directory",
        "No merge conflicts",
        "Repository integrity (git fsck)",
        "Merge history preserved",
        "Backup tag exists",
        "No orphaned commits",
        "All service directories intact"
      ]
    }
  },

  "qa_signoff": null
}
