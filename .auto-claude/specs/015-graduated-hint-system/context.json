{
  "task_description": "# Graduated Hint System\n\nImplement a multi-level hint system that progressively reveals puzzle-solving insights without fully spoiling the solution. Four escalating levels from strategic guidance to partial solutions.\n\n## Rationale\nMany users want help without complete spoilers. This directly addresses the pain point of wanting to learn strategies without ruining the puzzle experience, differentiating from online solution lookups.\n\n## User Stories\n- As a puzzle learner, I want progressive hints so that I can learn without complete spoilers\n- As a casual player, I want a nudge to get unstuck without revealing the whole solution\n- As a power user, I want to understand why a placement is correct, not just what it is\n\n## Acceptance Criteria\n- [ ] Level 1: General strategy hints without revealing specifics\n- [ ] Level 2: Identify which region or constraint to focus on\n- [ ] Level 3: Reveal a specific cell placement as a nudge\n- [ ] Level 4: Show partial solution for stuck areas\n- [ ] Users can progress through hint levels at their own pace\n",
  "scoped_services": ["pips-agent", "pips-solver"],
  "files_to_modify": {
    "pips-agent": [
      "main.py",
      "tools/provide_hints.py",
      "utils/hint_engine.py"
    ],
    "pips-solver": [
      "src/app/screens/PuzzleViewerScreen.tsx",
      "src/app/components/HintModal.tsx"
    ]
  },
  "files_to_reference": [
    "cv-service/main.py",
    "pips-solver/src/app/components/AIVerificationModal.tsx",
    "pips-solver/src/app/components/ui/Button.tsx",
    "pips-agent/tools/provide_hints.py",
    "pips-agent/utils/hint_engine.py"
  ],
  "patterns": {
    "fastapi_pattern": "cv-service/main.py shows FastAPI endpoint structure with Pydantic models, CORS middleware, structured JSON responses with success/error fields",
    "react_native_modal_pattern": "AIVerificationModal.tsx shows Modal component with visibility state, loading states, Button variants, Card layouts",
    "button_component_pattern": "Button.tsx shows themed component with variants (primary/secondary/ghost), sizes (small/medium/large), loading states, press animations",
    "existing_hints_pattern": "tools/provide_hints.py uses MCP tool decorator, takes YAML spec, calls hint_engine.generate_hints() which returns strategic hints as list of strings"
  },
  "existing_implementations": {
    "description": "Found existing single-level hint system in pips-agent",
    "relevant_files": [
      "pips-agent/tools/provide_hints.py",
      "pips-agent/utils/hint_engine.py"
    ],
    "details": "Current hints are strategic only (suggest_starting_region, analyze_constraints) - NOT graduated 4-level system. Need to extend with Level 1-4 logic. pips-agent is CLI-based (Claude SDK) not HTTP server - needs FastAPI endpoint for frontend to call."
  },
  "architecture_decisions": {
    "backend_approach": "Add FastAPI server to pips-agent (similar to cv-service pattern) with /generate-hint POST endpoint. Keep existing hint_engine.py logic, extend with 4-level generation.",
    "frontend_approach": "Create HintModal component (pattern from AIVerificationModal.tsx) with 4 buttons for levels, integrate into PuzzleViewerScreen.tsx",
    "state_management": "useState for modal visibility, hint content, current level. AsyncStorage to persist last hint level across sessions.",
    "hint_generation_strategy": "Level 1-2: Use existing hint_engine strategic analysis. Level 3-4: Require solve_puzzle logic to get partial solutions."
  },
  "technology_stack": {
    "pips-agent": {
      "current": ["Python", "Claude Agent SDK", "PyYAML"],
      "additions": ["FastAPI", "uvicorn", "pydantic"]
    },
    "pips-solver": {
      "current": ["TypeScript", "React Native", "Expo", "AsyncStorage"],
      "additions": []
    }
  },
  "created_at": "2025-12-22T03:13:20.370483",
  "updated_at": "2025-12-22T11:30:00.000000"
}
